<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="UTF-8">
        <title>TSA</title>
        <style>
            body { font-family: sans-serif; line-height: 1.6; padding: 20px; }
            .container { max-width: 800px; margin: auto; border: 1px solid #ddd; padding: 25px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
            h1 { color: #333; }
            h2 { color: #555; border-bottom: 2px solid #eee; padding-bottom: 10px; }
            .original-text { background-color: #f9f9f9; border-left: 5px solid #ccc; padding: 15px; margin-bottom: 20px; word-wrap: break-word; }
            b { color: #0056b3; }
        </style>
    </head>
    <body>
        <div class="container">
            <h1>TSA</h1>
            <h2>元のテキスト</h2>
            <div class="original-text">
                <p>import pyperclip<br>import webbrowser<br>import time<br>import os<br>import google.generativeai as genai<br><br>API_KEY = "YOUR_API_KEY"<br><br>PROMPT_TEMPLATE = """<br>以下の文章から重要と思われる単語を抽出してください<br>その単語の意味を誰にでもわかりやすく簡潔に日本語で説明してください<br><br>結果は以下のフォーマットで、Markdown形式で入力してください<br>**抽出した単語**: 意味と解説<br>---<br>文章:<br>{text}<br>"""<br><br>def extract_keywords_and_meanings(text_to_analyze):<br>    try:<br>        genai.configure(api_key=API_KEY)<br>        model = genai.GenerativeModel('gemini-1.5-flash')<br>        prompt = PROMPT_TEMPLATE.format(text=text_to_analyze)<br>        response = model.generate_content(prompt)<br>        return response.text<br>    except Exception as e:<br>        print(f"Gemini APIエラー: {e}")<br>        return f"APIの呼び出し中にエラーが発生しました。 \n{e}"<br>    <br>def create_and_open_html(original_text, analysis_result):<br>    try:<br>        script_dir = os.path.dirname(os.path.abspath(__file__))<br>        html_template_path = os.path.join(script_dir, "TSA.html")<br>        with open(html_template_path, "r", encoding="utf-8") as file:<br>            html_content = file.read()<br>    except FileNotFoundError:<br>        print("エラー:　TSA.htmlが見つかりません。")<br>        return<br><br>    html_body = analysis_result.replace('**', '<b>').replace('**', '</b>').replace('\n', '<br>')<br>    original_text_html = original_text.replace('\n', '<br>')<br><br>    html_content = html_content.replace("%%ORIGINAL_TEXT%%", original_text_html)<br>    html_content = html_content.replace("<b>pyperclip<b>: クリップボードの内容を読み書きするライブラリです。パソコンのクリップボードにあるテキストをプログラムで取得したり、テキストをクリップボードにコピーしたりできます。<br><br>---<br><b>webbrowser<b>: ウェブブラウザをプログラムから操作するライブラリです。このライブラリを使うと、プログラムの中で指定したURLのウェブサイトを自動的に開くことができます。<br><br>---<br><b>time<b>: 時間に関する機能を提供するライブラリです。プログラムの実行時間を計測したり、プログラムの一時停止などを制御できます。<br><br>---<br><b>os<b>: オペレーティングシステム（OS）を操作するためのライブラリです。ファイルの操作（作成、削除、読み書きなど）や、プログラムの実行環境に関する情報を取得できます。<br><br>---<br><b>google.generativeai<b>: Googleが提供する、自然言語処理などの生成AIモデルを利用するためのライブラリです。このライブラリを使うと、テキストの生成、要約、翻訳などの高度な機能を利用できます。<br><br>---<br><b>API_KEY<b>:  API（アプリケーション・プログラミング・インターフェース）を利用するためのキーです。  APIを利用する際に、自分のアカウントを識別し、アクセスを許可するために必要になります。この例では、Googleの生成AIモデルを使うためのキーです。<br><br>---<br><b>PROMPT_TEMPLATE<b>:  AIモデルに指示を与えるためのテンプレートです。このプログラムでは、AIモデルに対してどのような処理を行ってほしいかを指定するための文章が書かれています。<br><br>---<br><b>extract_keywords_and_meanings<b>:  このプログラムの中で定義された関数で、テキストからキーワードを抽出し、その意味を説明する処理を行います。<br><br>---<br><b>create_and_open_html<b>:  このプログラムの中で定義された関数で、分析結果をHTMLファイルとして作成し、ウェブブラウザで開きます。<br><br>---<br><b>main<b>: プログラムのメイン関数です。プログラム全体の流れを制御します。<br><br>---<br><b>Gemini<b>: Googleが開発した大規模言語モデルです。このプログラムでは、テキストの分析にGeminiが使われています。<br><br><br>", html_body)<br><br>    try:<br>        filepath = f"analysis_result_{int(time.time())}.html"<br>        with open(filepath, "w", encoding="utf-8") as f:<br>            f.write(html_content)<br><br>        full_path = os.path.join(script_dir, "analysis_result.html")<br><br>        webbrowser.open(f"file://{full_path}")<br>        print(f"-> 結果を {filepath} に保存し、ブラウザで開きました")<br>    <br>    except Exception as e:<br>        print(f"HTMLファイルの作成または氷人い失敗しました: {e}")<br><br><br>def main():<br>    print("クリップボードの監視を開始")<br>    print("終了するには http とコピーするか、ctrl + C を押してください")<br>    print("-" * 50)<br><br>    latest_text = ""<br>    try:<br>        while True:<br>            current_text = pyperclip.paste()<br>            if current_text and current_text != latest_text:<br>                latest_text = current_text<br><br>                if latest_text.strip().lower() == "http":<br>                    break<br>                <br>                print(f"新しいテキストをコピーしました")<br>                analysis_result = extract_keywords_and_meanings(latest_text)<br><br>                create_and_open_html(latest_text, analysis_result)<br><br>            time.sleep(1)<br>    <br>    except KeyboardInterrupt:<br>        print("\nプログラムが中断されました")<br>    <br>if __name__ == "__main__":<br>    if API_KEY == 'YOUR_API_KEY':<br>        print("エラー: コード上部の API_WKEYを自身のGeminiAPIキーに置き換えてください")<br>    else:<br>        main()</p>
            </div>
            <h2>単語の解説</h2>
            <p><b>pyperclip<b>: クリップボードの内容を読み書きするライブラリです。パソコンのクリップボードにあるテキストをプログラムで取得したり、テキストをクリップボードにコピーしたりできます。<br><br>---<br><b>webbrowser<b>: ウェブブラウザをプログラムから操作するライブラリです。このライブラリを使うと、プログラムの中で指定したURLのウェブサイトを自動的に開くことができます。<br><br>---<br><b>time<b>: 時間に関する機能を提供するライブラリです。プログラムの実行時間を計測したり、プログラムの一時停止などを制御できます。<br><br>---<br><b>os<b>: オペレーティングシステム（OS）を操作するためのライブラリです。ファイルの操作（作成、削除、読み書きなど）や、プログラムの実行環境に関する情報を取得できます。<br><br>---<br><b>google.generativeai<b>: Googleが提供する、自然言語処理などの生成AIモデルを利用するためのライブラリです。このライブラリを使うと、テキストの生成、要約、翻訳などの高度な機能を利用できます。<br><br>---<br><b>API_KEY<b>:  API（アプリケーション・プログラミング・インターフェース）を利用するためのキーです。  APIを利用する際に、自分のアカウントを識別し、アクセスを許可するために必要になります。この例では、Googleの生成AIモデルを使うためのキーです。<br><br>---<br><b>PROMPT_TEMPLATE<b>:  AIモデルに指示を与えるためのテンプレートです。このプログラムでは、AIモデルに対してどのような処理を行ってほしいかを指定するための文章が書かれています。<br><br>---<br><b>extract_keywords_and_meanings<b>:  このプログラムの中で定義された関数で、テキストからキーワードを抽出し、その意味を説明する処理を行います。<br><br>---<br><b>create_and_open_html<b>:  このプログラムの中で定義された関数で、分析結果をHTMLファイルとして作成し、ウェブブラウザで開きます。<br><br>---<br><b>main<b>: プログラムのメイン関数です。プログラム全体の流れを制御します。<br><br>---<br><b>Gemini<b>: Googleが開発した大規模言語モデルです。このプログラムでは、テキストの分析にGeminiが使われています。<br><br><br></p>
        </div>
    </body>
</html>